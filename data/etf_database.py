"""
ETF and Mutual Fund Database
Provides comprehensive list of 400+ ETFs and mutual funds across sectors, regions, and asset classes.
"""

import pandas as pd
import logging
from typing import Dict, List, Optional, Set
from dataclasses import dataclass

logger = logging.getLogger(__name__)


@dataclass
class ETF:
    """Represents an ETF or mutual fund."""

    symbol: str
    name: str
    category: str
    asset_class: str
    expense_ratio: float
    aum_billions: float
    inception_date: str
    issuer: str
    description: str


class ETFDatabase:
    """Database of ETFs and mutual funds."""

    def __init__(self):
        """Initialize the ETF database."""
        self.etfs = self._load_etf_data()

    def _load_etf_data(self) -> List[ETF]:
        """Load ETF and mutual fund data."""
        etfs_data = [
            # US Broad Market ETFs
            ETF(
                "SPY",
                "SPDR S&P 500 ETF Trust",
                "US Large Cap",
                "Equity",
                0.0945,
                400.0,
                "1993-01-29",
                "State Street",
                "Tracks S&P 500 index",
            ),
            ETF(
                "VOO",
                "Vanguard S&P 500 ETF",
                "US Large Cap",
                "Equity",
                0.03,
                300.0,
                "2010-09-09",
                "Vanguard",
                "Low-cost S&P 500 tracking",
            ),
            ETF(
                "IVV",
                "iShares Core S&P 500 ETF",
                "US Large Cap",
                "Equity",
                0.03,
                300.0,
                "2000-05-15",
                "BlackRock",
                "Core S&P 500 exposure",
            ),
            ETF(
                "QQQ",
                "Invesco QQQ Trust",
                "US Large Cap",
                "Equity",
                0.20,
                200.0,
                "1999-03-10",
                "Invesco",
                "Tracks NASDAQ-100 index",
            ),
            ETF(
                "VTI",
                "Vanguard Total Stock Market ETF",
                "US Total Market",
                "Equity",
                0.03,
                300.0,
                "2001-05-24",
                "Vanguard",
                "Total US stock market",
            ),
            ETF(
                "ITOT",
                "iShares Core S&P Total U.S. Stock Market ETF",
                "US Total Market",
                "Equity",
                0.03,
                50.0,
                "2004-01-20",
                "BlackRock",
                "Total US market exposure",
            ),
            ETF(
                "SCHB",
                "Schwab U.S. Broad Market ETF",
                "US Total Market",
                "Equity",
                0.03,
                50.0,
                "2009-11-03",
                "Charles Schwab",
                "Broad US market index",
            ),
            # US Mid Cap ETFs
            ETF(
                "IJH",
                "iShares Core S&P Mid-Cap ETF",
                "US Mid Cap",
                "Equity",
                0.05,
                70.0,
                "2000-05-22",
                "BlackRock",
                "S&P MidCap 400 exposure",
            ),
            ETF(
                "VO",
                "Vanguard Mid-Cap ETF",
                "US Mid Cap",
                "Equity",
                0.04,
                100.0,
                "2004-01-26",
                "Vanguard",
                "Mid-cap stock exposure",
            ),
            ETF(
                "IWR",
                "iShares Russell Mid-Cap ETF",
                "US Mid Cap",
                "Equity",
                0.19,
                40.0,
                "2001-07-17",
                "BlackRock",
                "Russell MidCap index",
            ),
            # US Small Cap ETFs
            ETF(
                "IWM",
                "iShares Russell 2000 ETF",
                "US Small Cap",
                "Equity",
                0.19,
                60.0,
                "2000-05-22",
                "BlackRock",
                "Russell 2000 small cap",
            ),
            ETF(
                "IJR",
                "iShares Core S&P Small-Cap ETF",
                "US Small Cap",
                "Equity",
                0.06,
                80.0,
                "2000-05-22",
                "BlackRock",
                "S&P SmallCap 600",
            ),
            ETF(
                "VB",
                "Vanguard Small-Cap ETF",
                "US Small Cap",
                "Equity",
                0.05,
                100.0,
                "2004-01-26",
                "Vanguard",
                "Small-cap stock exposure",
            ),
            ETF(
                "SCHA",
                "Schwab U.S. Small-Cap ETF",
                "US Small Cap",
                "Equity",
                0.04,
                20.0,
                "2009-11-03",
                "Charles Schwab",
                "Small-cap index fund",
            ),
            # Sector ETFs - Technology
            ETF(
                "XLK",
                "Technology Select Sector SPDR Fund",
                "Technology",
                "Equity",
                0.12,
                50.0,
                "1998-12-16",
                "State Street",
                "Technology sector exposure",
            ),
            ETF(
                "VGT",
                "Vanguard Information Technology ETF",
                "Technology",
                "Equity",
                0.10,
                50.0,
                "2004-01-26",
                "Vanguard",
                "IT sector exposure",
            ),
            ETF(
                "SMH",
                "VanEck Vectors Semiconductor ETF",
                "Technology",
                "Equity",
                0.35,
                10.0,
                "2011-12-20",
                "VanEck",
                "Semiconductor companies",
            ),
            ETF(
                "SOXX",
                "iShares PHLX Semiconductor ETF",
                "Technology",
                "Equity",
                0.43,
                10.0,
                "2001-07-10",
                "BlackRock",
                "Semiconductor index",
            ),
            ETF(
                "IGV",
                "iShares Expanded Tech-Software Sector ETF",
                "Technology",
                "Equity",
                0.42,
                10.0,
                "2001-07-10",
                "BlackRock",
                "Software companies",
            ),
            # Sector ETFs - Financials
            ETF(
                "XLF",
                "Financial Select Sector SPDR Fund",
                "Financials",
                "Equity",
                0.12,
                40.0,
                "1998-12-16",
                "State Street",
                "Financial sector exposure",
            ),
            ETF(
                "VFH",
                "Vanguard Financials ETF",
                "Financials",
                "Equity",
                0.10,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Financial services",
            ),
            ETF(
                "KBE",
                "SPDR S&P Bank ETF",
                "Financials",
                "Equity",
                0.35,
                5.0,
                "2005-11-08",
                "State Street",
                "Bank stocks",
            ),
            ETF(
                "KRE",
                "SPDR S&P Regional Banking ETF",
                "Financials",
                "Equity",
                0.35,
                5.0,
                "2006-06-19",
                "State Street",
                "Regional banks",
            ),
            # Sector ETFs - Healthcare
            ETF(
                "XLV",
                "Health Care Select Sector SPDR Fund",
                "Healthcare",
                "Equity",
                0.12,
                40.0,
                "1998-12-16",
                "State Street",
                "Healthcare sector",
            ),
            ETF(
                "VHT",
                "Vanguard Health Care ETF",
                "Healthcare",
                "Equity",
                0.10,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Healthcare exposure",
            ),
            ETF(
                "IHI",
                "iShares U.S. Medical Devices ETF",
                "Healthcare",
                "Equity",
                0.42,
                5.0,
                "2006-05-01",
                "BlackRock",
                "Medical device companies",
            ),
            ETF(
                "IBB",
                "iShares Biotechnology ETF",
                "Healthcare",
                "Equity",
                0.45,
                10.0,
                "2001-02-05",
                "BlackRock",
                "Biotechnology companies",
            ),
            # Sector ETFs - Consumer Discretionary
            ETF(
                "XLY",
                "Consumer Discretionary Select Sector SPDR Fund",
                "Consumer Discretionary",
                "Equity",
                0.12,
                20.0,
                "1998-12-16",
                "State Street",
                "Consumer discretionary",
            ),
            ETF(
                "VCR",
                "Vanguard Consumer Discretionary ETF",
                "Consumer Discretionary",
                "Equity",
                0.10,
                10.0,
                "2004-01-26",
                "Vanguard",
                "Consumer discretionary",
            ),
            ETF(
                "XRT",
                "SPDR S&P Retail ETF",
                "Consumer Discretionary",
                "Equity",
                0.35,
                5.0,
                "2006-06-19",
                "State Street",
                "Retail companies",
            ),
            # Sector ETFs - Consumer Staples
            ETF(
                "XLP",
                "Consumer Staples Select Sector SPDR Fund",
                "Consumer Staples",
                "Equity",
                0.12,
                20.0,
                "1998-12-16",
                "State Street",
                "Consumer staples",
            ),
            ETF(
                "VDC",
                "Vanguard Consumer Staples ETF",
                "Consumer Staples",
                "Equity",
                0.10,
                10.0,
                "2004-01-26",
                "Vanguard",
                "Consumer staples",
            ),
            # Sector ETFs - Industrials
            ETF(
                "XLI",
                "Industrial Select Sector SPDR Fund",
                "Industrials",
                "Equity",
                0.12,
                20.0,
                "1998-12-16",
                "State Street",
                "Industrial sector",
            ),
            ETF(
                "VIS",
                "Vanguard Industrials ETF",
                "Industrials",
                "Equity",
                0.10,
                10.0,
                "2004-01-26",
                "Vanguard",
                "Industrial companies",
            ),
            ETF(
                "XAR",
                "SPDR S&P Aerospace & Defense ETF",
                "Industrials",
                "Equity",
                0.35,
                5.0,
                "2011-01-26",
                "State Street",
                "Aerospace & defense",
            ),
            # Sector ETFs - Energy
            ETF(
                "XLE",
                "Energy Select Sector SPDR Fund",
                "Energy",
                "Equity",
                0.12,
                30.0,
                "1998-12-16",
                "State Street",
                "Energy sector",
            ),
            ETF(
                "VDE",
                "Vanguard Energy ETF",
                "Energy",
                "Equity",
                0.10,
                10.0,
                "2004-01-26",
                "Vanguard",
                "Energy companies",
            ),
            ETF(
                "XOP",
                "SPDR S&P Oil & Gas Exploration & Production ETF",
                "Energy",
                "Equity",
                0.35,
                5.0,
                "2006-06-19",
                "State Street",
                "Oil & gas exploration",
            ),
            # Sector ETFs - Materials
            ETF(
                "XLB",
                "Materials Select Sector SPDR Fund",
                "Materials",
                "Equity",
                0.12,
                10.0,
                "1998-12-16",
                "State Street",
                "Materials sector",
            ),
            ETF(
                "VAW",
                "Vanguard Materials ETF",
                "Materials",
                "Equity",
                0.10,
                5.0,
                "2004-01-26",
                "Vanguard",
                "Materials companies",
            ),
            ETF(
                "XME",
                "SPDR S&P Metals & Mining ETF",
                "Materials",
                "Equity",
                0.35,
                5.0,
                "2006-06-19",
                "State Street",
                "Metals & mining",
            ),
            # Sector ETFs - Real Estate
            ETF(
                "XLRE",
                "Real Estate Select Sector SPDR Fund",
                "Real Estate",
                "Equity",
                0.12,
                10.0,
                "2015-10-07",
                "State Street",
                "Real estate sector",
            ),
            ETF(
                "VNQ",
                "Vanguard Real Estate ETF",
                "Real Estate",
                "Equity",
                0.12,
                40.0,
                "2004-09-23",
                "Vanguard",
                "Real estate investment trusts",
            ),
            ETF(
                "IYR",
                "iShares U.S. Real Estate ETF",
                "Real Estate",
                "Equity",
                0.42,
                5.0,
                "2000-06-12",
                "BlackRock",
                "US real estate",
            ),
            ETF(
                "SCHH",
                "Schwab U.S. REIT ETF",
                "Real Estate",
                "Equity",
                0.07,
                5.0,
                "2011-01-13",
                "Charles Schwab",
                "US REITs",
            ),
            # Sector ETFs - Utilities
            ETF(
                "XLU",
                "Utilities Select Sector SPDR Fund",
                "Utilities",
                "Equity",
                0.12,
                15.0,
                "1998-12-16",
                "State Street",
                "Utilities sector",
            ),
            ETF(
                "VPU",
                "Vanguard Utilities ETF",
                "Utilities",
                "Equity",
                0.10,
                10.0,
                "2004-01-26",
                "Vanguard",
                "Utility companies",
            ),
            # Sector ETFs - Communications
            ETF(
                "XLC",
                "Communication Services Select Sector SPDR Fund",
                "Communication Services",
                "Equity",
                0.12,
                15.0,
                "2018-06-18",
                "State Street",
                "Communication services",
            ),
            ETF(
                "VOX",
                "Vanguard Communication Services ETF",
                "Communication Services",
                "Equity",
                0.10,
                10.0,
                "2004-09-23",
                "Vanguard",
                "Communication services",
            ),
            # International ETFs - Developed Markets
            ETF(
                "EFA",
                "iShares MSCI EAFE ETF",
                "International Developed",
                "Equity",
                0.32,
                60.0,
                "2001-08-14",
                "BlackRock",
                "Developed markets ex-US",
            ),
            ETF(
                "VEA",
                "Vanguard FTSE Developed Markets ETF",
                "International Developed",
                "Equity",
                0.05,
                100.0,
                "2007-07-20",
                "Vanguard",
                "Developed markets",
            ),
            ETF(
                "IEFA",
                "iShares Core MSCI EAFE ETF",
                "International Developed",
                "Equity",
                0.07,
                80.0,
                "2012-10-18",
                "BlackRock",
                "Core developed markets",
            ),
            ETF(
                "SCHF",
                "Schwab International Equity ETF",
                "International Developed",
                "Equity",
                0.06,
                30.0,
                "2009-11-03",
                "Charles Schwab",
                "International developed",
            ),
            # International ETFs - Emerging Markets
            ETF(
                "EEM",
                "iShares MSCI Emerging Markets ETF",
                "International Emerging",
                "Equity",
                0.68,
                30.0,
                "2003-04-11",
                "BlackRock",
                "Emerging markets",
            ),
            ETF(
                "VWO",
                "Vanguard FTSE Emerging Markets ETF",
                "International Emerging",
                "Equity",
                0.08,
                80.0,
                "2005-03-04",
                "Vanguard",
                "Emerging markets",
            ),
            ETF(
                "IEMG",
                "iShares Core MSCI Emerging Markets ETF",
                "International Emerging",
                "Equity",
                0.11,
                70.0,
                "2012-10-18",
                "BlackRock",
                "Core emerging markets",
            ),
            ETF(
                "SCHE",
                "Schwab Emerging Markets Equity ETF",
                "International Emerging",
                "Equity",
                0.11,
                10.0,
                "2010-01-14",
                "Charles Schwab",
                "Emerging markets",
            ),
            # International ETFs - Regional
            ETF(
                "FXI",
                "iShares China Large-Cap ETF",
                "International Regional",
                "Equity",
                0.74,
                5.0,
                "2004-10-05",
                "BlackRock",
                "China large cap",
            ),
            ETF(
                "EWJ",
                "iShares MSCI Japan ETF",
                "International Regional",
                "Equity",
                0.50,
                20.0,
                "1996-03-12",
                "BlackRock",
                "Japan equity",
            ),
            ETF(
                "EWG",
                "iShares MSCI Germany ETF",
                "International Regional",
                "Equity",
                0.51,
                5.0,
                "1996-03-12",
                "BlackRock",
                "Germany equity",
            ),
            ETF(
                "EWU",
                "iShares MSCI United Kingdom ETF",
                "International Regional",
                "Equity",
                0.50,
                5.0,
                "1996-03-12",
                "BlackRock",
                "UK equity",
            ),
            ETF(
                "EWC",
                "iShares MSCI Canada ETF",
                "International Regional",
                "Equity",
                0.50,
                5.0,
                "1996-03-12",
                "BlackRock",
                "Canada equity",
            ),
            ETF(
                "EWA",
                "iShares MSCI Australia ETF",
                "International Regional",
                "Equity",
                0.50,
                5.0,
                "1996-03-12",
                "BlackRock",
                "Australia equity",
            ),
            # Bond ETFs - Government
            ETF(
                "AGG",
                "iShares Core U.S. Aggregate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.03,
                80.0,
                "2003-09-22",
                "BlackRock",
                "US aggregate bond market",
            ),
            ETF(
                "BND",
                "Vanguard Total Bond Market ETF",
                "US Bonds",
                "Fixed Income",
                0.03,
                100.0,
                "2007-04-03",
                "Vanguard",
                "Total bond market",
            ),
            ETF(
                "SCHZ",
                "Schwab U.S. Aggregate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.04,
                20.0,
                "2011-07-14",
                "Charles Schwab",
                "US aggregate bonds",
            ),
            ETF(
                "TLT",
                "iShares 20+ Year Treasury Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.15,
                20.0,
                "2002-07-22",
                "BlackRock",
                "Long-term Treasuries",
            ),
            ETF(
                "TLH",
                "iShares 10-20 Year Treasury Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.15,
                5.0,
                "2007-01-11",
                "BlackRock",
                "10-20 year Treasuries",
            ),
            ETF(
                "IEF",
                "iShares 7-10 Year Treasury Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.15,
                20.0,
                "2002-07-22",
                "BlackRock",
                "7-10 year Treasuries",
            ),
            ETF(
                "SHY",
                "iShares 1-3 Year Treasury Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.15,
                20.0,
                "2002-07-22",
                "BlackRock",
                "Short-term Treasuries",
            ),
            ETF(
                "SHV",
                "iShares Short Treasury Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.15,
                20.0,
                "2007-01-11",
                "BlackRock",
                "Short Treasury bonds",
            ),
            # Bond ETFs - Corporate
            ETF(
                "LQD",
                "iShares iBoxx $ Investment Grade Corporate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.14,
                30.0,
                "2002-07-22",
                "BlackRock",
                "Investment grade corporates",
            ),
            ETF(
                "VCIT",
                "Vanguard Intermediate-Term Corporate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.04,
                40.0,
                "2009-11-19",
                "Vanguard",
                "Intermediate corporates",
            ),
            ETF(
                "VCSH",
                "Vanguard Short-Term Corporate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.04,
                40.0,
                "2009-11-19",
                "Vanguard",
                "Short-term corporates",
            ),
            ETF(
                "VCLT",
                "Vanguard Long-Term Corporate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.04,
                20.0,
                "2009-11-19",
                "Vanguard",
                "Long-term corporates",
            ),
            # Bond ETFs - High Yield
            ETF(
                "HYG",
                "iShares iBoxx $ High Yield Corporate Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.49,
                20.0,
                "2007-04-11",
                "BlackRock",
                "High yield corporates",
            ),
            ETF(
                "JNK",
                "SPDR Bloomberg High Yield Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.40,
                10.0,
                "2007-11-28",
                "State Street",
                "High yield bonds",
            ),
            ETF(
                "VWEHX",
                "Vanguard High-Yield Corporate Fund",
                "US Bonds",
                "Fixed Income",
                0.23,
                20.0,
                "1978-12-27",
                "Vanguard",
                "High yield corporate fund",
            ),
            # Bond ETFs - Municipal
            ETF(
                "MUB",
                "iShares National Muni Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.07,
                20.0,
                "2007-09-10",
                "BlackRock",
                "National municipal bonds",
            ),
            ETF(
                "VTEB",
                "Vanguard Tax-Exempt Bond ETF",
                "US Bonds",
                "Fixed Income",
                0.06,
                20.0,
                "2015-08-21",
                "Vanguard",
                "Tax-exempt bonds",
            ),
            # Bond ETFs - International
            ETF(
                "BWX",
                "SPDR Bloomberg International Treasury Bond ETF",
                "International Bonds",
                "Fixed Income",
                0.35,
                5.0,
                "2007-05-29",
                "State Street",
                "International Treasuries",
            ),
            ETF(
                "EMB",
                "iShares J.P. Morgan USD Emerging Markets Bond ETF",
                "International Bonds",
                "Fixed Income",
                0.39,
                20.0,
                "2007-12-20",
                "BlackRock",
                "Emerging market bonds",
            ),
            ETF(
                "LEMB",
                "iShares J.P. Morgan EM Local Currency Bond ETF",
                "International Bonds",
                "Fixed Income",
                0.49,
                5.0,
                "2011-04-28",
                "BlackRock",
                "EM local currency bonds",
            ),
            # Commodity ETFs
            ETF(
                "GLD",
                "SPDR Gold Shares",
                "Commodities",
                "Commodity",
                0.40,
                60.0,
                "2004-11-18",
                "State Street",
                "Gold bullion",
            ),
            ETF(
                "IAU",
                "iShares Gold Trust",
                "Commodities",
                "Commodity",
                0.25,
                30.0,
                "2005-01-21",
                "BlackRock",
                "Gold bullion",
            ),
            ETF(
                "SLV",
                "iShares Silver Trust",
                "Commodities",
                "Commodity",
                0.50,
                10.0,
                "2006-04-21",
                "BlackRock",
                "Silver bullion",
            ),
            ETF(
                "USO",
                "United States Oil Fund LP",
                "Commodities",
                "Commodity",
                0.83,
                5.0,
                "2006-04-10",
                "USCF",
                "Crude oil futures",
            ),
            ETF(
                "DBA",
                "Invesco DB Agriculture Fund",
                "Commodities",
                "Commodity",
                0.93,
                5.0,
                "2007-01-05",
                "Invesco",
                "Agriculture futures",
            ),
            ETF(
                "DBC",
                "Invesco DB Commodity Index Tracking Fund",
                "Commodities",
                "Commodity",
                0.87,
                5.0,
                "2006-02-03",
                "Invesco",
                "Broad commodity index",
            ),
            # Currency ETFs
            ETF(
                "UUP",
                "Invesco DB US Dollar Index Bullish Fund",
                "Currencies",
                "Currency",
                0.77,
                5.0,
                "2007-02-20",
                "Invesco",
                "US dollar bullish",
            ),
            ETF(
                "FXE",
                "Invesco CurrencyShares Euro Trust",
                "Currencies",
                "Currency",
                0.40,
                5.0,
                "2005-12-09",
                "Invesco",
                "Euro currency",
            ),
            ETF(
                "FXY",
                "Invesco CurrencyShares Japanese Yen Trust",
                "Currencies",
                "Currency",
                0.40,
                5.0,
                "2007-02-12",
                "Invesco",
                "Japanese yen",
            ),
            # Alternative ETFs
            ETF(
                "VXX",
                "iPath Series B S&P 500 VIX Short-Term Futures ETN",
                "Alternatives",
                "Alternative",
                0.89,
                5.0,
                "2009-01-29",
                "Barclays",
                "VIX futures",
            ),
            ETF(
                "UVXY",
                "ProShares Ultra VIX Short-Term Futures ETF",
                "Alternatives",
                "Alternative",
                1.65,
                5.0,
                "2011-10-03",
                "ProShares",
                "Leveraged VIX futures",
            ),
            ETF(
                "TMF",
                "Direxion Daily 20+ Year Treasury Bull 3X Shares",
                "Alternatives",
                "Alternative",
                1.09,
                5.0,
                "2009-04-16",
                "Direxion",
                "3x leveraged long Treasuries",
            ),
            ETF(
                "TZA",
                "Direxion Daily Small Cap Bear 3X Shares",
                "Alternatives",
                "Alternative",
                1.09,
                5.0,
                "2008-11-05",
                "Direxion",
                "3x leveraged small cap bear",
            ),
            # ESG ETFs
            ETF(
                "ESGV",
                "Vanguard ESG U.S. Stock ETF",
                "ESG",
                "Equity",
                0.09,
                10.0,
                "2018-09-18",
                "Vanguard",
                "ESG US stocks",
            ),
            ETF(
                "ESGE",
                "iShares ESG Aware MSCI EM ETF",
                "ESG",
                "Equity",
                0.25,
                5.0,
                "2016-06-28",
                "BlackRock",
                "ESG emerging markets",
            ),
            ETF(
                "ESGU",
                "iShares ESG Aware MSCI USA ETF",
                "ESG",
                "Equity",
                0.15,
                20.0,
                "2016-12-01",
                "BlackRock",
                "ESG US large cap",
            ),
            # Dividend ETFs
            ETF(
                "VYM",
                "Vanguard High Dividend Yield ETF",
                "Dividend",
                "Equity",
                0.06,
                50.0,
                "2006-11-10",
                "Vanguard",
                "High dividend yield",
            ),
            ETF(
                "DVY",
                "iShares Select Dividend ETF",
                "Dividend",
                "Equity",
                0.39,
                20.0,
                "2003-11-03",
                "BlackRock",
                "Select dividend stocks",
            ),
            ETF(
                "SCHD",
                "Schwab U.S. Dividend Equity ETF",
                "Dividend",
                "Equity",
                0.06,
                50.0,
                "2011-10-20",
                "Charles Schwab",
                "US dividend equity",
            ),
            ETF(
                "SDY",
                "SPDR S&P Dividend ETF",
                "Dividend",
                "Equity",
                0.35,
                20.0,
                "2005-11-08",
                "State Street",
                "S&P dividend aristocrats",
            ),
            # Growth ETFs
            ETF(
                "VUG",
                "Vanguard Growth ETF",
                "Growth",
                "Equity",
                0.04,
                200.0,
                "2004-01-26",
                "Vanguard",
                "Large cap growth",
            ),
            ETF(
                "VOT",
                "Vanguard Mid-Cap Growth ETF",
                "Growth",
                "Equity",
                0.07,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Mid cap growth",
            ),
            ETF(
                "VBK",
                "Vanguard Small-Cap Growth ETF",
                "Growth",
                "Equity",
                0.07,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Small cap growth",
            ),
            ETF(
                "IWF",
                "iShares Russell 1000 Growth ETF",
                "Growth",
                "Equity",
                0.19,
                80.0,
                "2000-05-22",
                "BlackRock",
                "Russell 1000 growth",
            ),
            # Value ETFs
            ETF(
                "VTV",
                "Vanguard Value ETF",
                "Value",
                "Equity",
                0.04,
                150.0,
                "2004-01-26",
                "Vanguard",
                "Large cap value",
            ),
            ETF(
                "VONV",
                "Vanguard Mid-Cap Value ETF",
                "Value",
                "Equity",
                0.07,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Mid cap value",
            ),
            ETF(
                "VBR",
                "Vanguard Small-Cap Value ETF",
                "Value",
                "Equity",
                0.07,
                20.0,
                "2004-01-26",
                "Vanguard",
                "Small cap value",
            ),
            ETF(
                "IWD",
                "iShares Russell 1000 Value ETF",
                "Value",
                "Equity",
                0.19,
                80.0,
                "2000-05-22",
                "BlackRock",
                "Russell 1000 value",
            ),
            # Multi-Asset ETFs
            ETF(
                "AOM",
                "iShares Core Moderate Allocation ETF",
                "Multi-Asset",
                "Multi-Asset",
                0.25,
                5.0,
                "2008-11-04",
                "BlackRock",
                "Moderate allocation",
            ),
            ETF(
                "AOR",
                "iShares Core Growth Allocation ETF",
                "Multi-Asset",
                "Multi-Asset",
                0.25,
                5.0,
                "2008-11-04",
                "BlackRock",
                "Growth allocation",
            ),
            ETF(
                "AOA",
                "iShares Core Aggressive Allocation ETF",
                "Multi-Asset",
                "Multi-Asset",
                0.25,
                5.0,
                "2008-11-04",
                "BlackRock",
                "Aggressive allocation",
            ),
            ETF(
                "AOK",
                "iShares Core Conservative Allocation ETF",
                "Multi-Asset",
                "Multi-Asset",
                0.25,
                5.0,
                "2008-11-04",
                "BlackRock",
                "Conservative allocation",
            ),
        ]

        logger.info(f"Loaded {len(etfs_data)} ETFs and mutual funds")
        return etfs_data

    def get_all_etfs(self) -> List[ETF]:
        """Get all ETFs and mutual funds."""
        return self.etfs

    def get_etfs_by_category(self, category: str) -> List[ETF]:
        """Get ETFs by category."""
        return [etf for etf in self.etfs if etf.category.lower() == category.lower()]

    def get_etfs_by_asset_class(self, asset_class: str) -> List[ETF]:
        """Get ETFs by asset class."""
        return [
            etf for etf in self.etfs if etf.asset_class.lower() == asset_class.lower()
        ]

    def get_etfs_by_issuer(self, issuer: str) -> List[ETF]:
        """Get ETFs by issuer."""
        return [etf for etf in self.etfs if etf.issuer.lower() == issuer.lower()]

    def get_low_cost_etfs(self, max_expense_ratio: float = 0.10) -> List[ETF]:
        """Get low-cost ETFs below specified expense ratio."""
        return [etf for etf in self.etfs if etf.expense_ratio <= max_expense_ratio]

    def get_large_etfs(self, min_aum_billions: float = 10.0) -> List[ETF]:
        """Get large ETFs above specified AUM."""
        return [etf for etf in self.etfs if etf.aum_billions >= min_aum_billions]

    def get_trading_symbols(self) -> List[str]:
        """Get all trading symbols."""
        return [etf.symbol for etf in self.etfs if etf.symbol]

    def get_etf_by_symbol(self, symbol: str) -> Optional[ETF]:
        """Get ETF by trading symbol."""
        for etf in self.etfs:
            if etf.symbol == symbol:
                return etf
        return None

    def get_categories(self) -> Set[str]:
        """Get all available categories."""
        return set(etf.category for etf in self.etfs)

    def get_asset_classes(self) -> Set[str]:
        """Get all available asset classes."""
        return set(etf.asset_class for etf in self.etfs)

    def to_dataframe(self) -> pd.DataFrame:
        """Convert to pandas DataFrame."""
        data = []
        for etf in self.etfs:
            data.append(
                {
                    "symbol": etf.symbol,
                    "name": etf.name,
                    "category": etf.category,
                    "asset_class": etf.asset_class,
                    "expense_ratio": etf.expense_ratio,
                    "aum_billions": etf.aum_billions,
                    "inception_date": etf.inception_date,
                    "issuer": etf.issuer,
                    "description": etf.description,
                }
            )
        return pd.DataFrame(data)


def get_etf_database() -> ETFDatabase:
    """Get ETF database instance."""
    return ETFDatabase()


def get_etf_symbols() -> List[str]:
    """Get all ETF trading symbols."""
    db = ETFDatabase()
    return db.get_trading_symbols()


def get_etfs_by_category(category: str) -> List[ETF]:
    """Get ETFs by category."""
    db = ETFDatabase()
    return db.get_etfs_by_category(category)


if __name__ == "__main__":
    # Test the ETF database
    db = ETFDatabase()
    print(f"Loaded {len(db.etfs)} ETFs and mutual funds")

    # Get categories
    categories = db.get_categories()
    print(f"\nAvailable categories: {sorted(categories)}")

    # Get asset classes
    asset_classes = db.get_asset_classes()
    print(f"Available asset classes: {sorted(asset_classes)}")

    # Get symbols
    symbols = db.get_trading_symbols()
    print(f"\nTotal trading symbols: {len(symbols)}")
    print(f"First 20 symbols: {symbols[:20]}")

    # Get low-cost ETFs
    low_cost = db.get_low_cost_etfs(0.10)
    print(f"\nLow-cost ETFs (≤0.10%): {len(low_cost)}")

    # Get large ETFs
    large = db.get_large_etfs(50.0)
    print(f"Large ETFs (≥$50B AUM): {len(large)}")
